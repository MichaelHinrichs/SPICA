This is just SPICA with these 3 pull requests merged into it:
gdkchan#85
gdkchan#73
gdkchan#50

untested. AS-IS.
